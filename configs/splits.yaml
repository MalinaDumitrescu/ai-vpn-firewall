seed: 42

# Primary constraint: keep CAPTURE integrity and overall split sizes (70/15/15)
capture_ratios:
  train: 0.70
  val: 0.15
  test: 0.15

# Make this match what your constraints + VNAT can realistically deliver.
# Your current achieved trainable ratios are ~0.93/0.038/0.030.
flow_ratios:
  train: 0.85   #0.92 #0.70
  val: 0.07 #0.04  #0.15
  test: 0.08 #0.04  #0.15

# Your VPN trainable reality:
# - total trainable VPN = 83, but 80+ of those are basically 1 per capture
# - you MUST have VPN present in val/test for threshold tuning
#
# With strict 70/15/15 *per-class* you would only get ~12-13 VPN captures in val/test,
# so setting 20 is often too aggressive.
vpn_trainable_flow_min:
  val: 0 #30 #10
  test: 0 #30 #10

# Ensure val/test aren't tiny in TOTAL trainable mass (helps avoid "empty" val/test)
# Use ABSOLUTE counts here (integers).
min_total_flows:
  val_frac: 0.0
  test_frac: 0.0
  val_abs: 0 #150      #90  or push it maybe towards 250?
  test_abs: 0 #400    #250

# this is what actually matters for training/tuning
min_total_trainable_flows:
  val_abs: 120 #250
  test_abs: 250

min_captures_per_class:
  train: 10
  val: 5
  test: 5

giants:
  top_k_per_class: 1 #2

# Guardrails (IMPORTANT: in your code, giant_flow_threshold applies to TRAINABLE mass now)
guardrails:
  keep_giants_in_train: true
  giant_flow_threshold: 1600 #900   # catches nonvpn_vimeo_capture1 (1188 trainable)
  min_vpn_captures:
    val: 12   #5
    test:  12 #5

    # force meaningful VPN mass into val/test
  min_vpn_heavy_captures:
    val: 1 #0 #1
    test: 1 #0 #1
  vpn_heavy_trainable_threshold: 50

  # keep enough VPN signal in TRAIN, otherwise training is weak
vpn_trainable_flow_min_train:
  train: 300 #180

  # avoid unrealistically VPN-dense val/test for threshold tuning
max_vpn_fraction_trainable:
  val: 0.25 #0.0 #0.25
  test: 0.25 #0.0 #0.25

tolerance:
  abs_flow_ratio: 0.20 #0.10

outputs:
  train_list: "data/splits/vnat_train_captures.txt"
  val_list: "data/splits/vnat_val_captures.txt"
  test_list: "data/splits/vnat_test_captures.txt"
  manifest: "data/splits/vnat_split_manifest.json"
